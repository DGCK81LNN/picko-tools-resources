# Indev (2021.10&ndash;2022.04)

从此时起，正式使用 C++ 开发。

## 早期实验性版本

  * (2021-10-06 15:27)

    ECS 系统测试。

  * (2021-11-02 22:51)

    碰撞检测测试。

  * (2021-11-03 18:38)

    碰撞检测测试，解决了对角碰撞时的问题。

  * (2022-01-17 20:42)【丢失】

    实现了地图文件的读取。地图文件 `waruwaru.cmp` 未丢失，可在 archives 目录找到。

  * test (2022-01-20 16:50)【丢失】

    实现了 PNG 贴图文件的读取。

  * fuck (2022-02-06 19:36)

## camwork

  * camwork (2022-02-08 19:36)【丢失】

    实现了相机系统。

## move

  * move (2022-02-09 19:49)【丢失】

    实现了移动平台的相关功能。

## convey

添加传送带。

  * convey (2022-02-15 08:18)【丢失】

    添加了传送带实体（`picko:conveyor`）。

  * fix (2022-02-17 22:07)【丢失】

  * latefix (2022-02-17 22:44)

    修复了加载空区块会导致游戏崩溃的 bug。

  * wtf (2022-02-18 09:18)

    增加了调试信息。

  * fyou (2022-02-18 09:26)

    增加了更多调试信息。

  * max (2022-02-18 18:11)

    解决了窗口最大化时游戏画面不放大的问题。

## psych

物理引擎修正。

  * psych (2022-03-14 15:23)

  * psycho (2022-03-16 17:29)

  * psychofixed (2022-03-16 17:34)

## sb

初步实现电锯。

  * sb (2022-03-20 16:26)

    添加电锯实体（`picko:sawblade`）。

  * base (2022-04-03 20:28)

    添加金属方块（`picko:metaltile`）。

## skate

初步实现滑块。

  * skate.5 (2022-04-09 20:11)

    添加了滑块实体（`picko:skater`）。

  * skate.51 (2022-04-09 22:49)

  * skate.5e (2022-04-10 22:58)

  * skate.5f (2022-04-11 09:23)

  * skate.5f1 (2022-04-13 16:09)

    修改测试地图使其变得更容易通过。

## unload

实现区块的卸载。

  * unload (2022-04-18 15:59)

      * 实现区块的卸载。

      * 为滑块添加材质。其有一只眼睛，总是看向玩家的方向。

  * unload.1 (2022-04-18 16:57)

    修复区块中的静止实体不能被卸载的 bug。

  * unload.1s（2022-04-18 17:24）

    宽或高为奇数的滑块现在可以正常显示。

## replay

实现游玩的录制和回放。

  * replay (2022-04-18 19:28)

      * 添加了 `record` 调试指令。

          * 使用 `record start` 开始录制游玩输入，`record end` 结束录制。

          * 录制后会在游戏目录内保存为 `_record.txt` 文件。其格式为 TSV，无标题行，每行为一条指令，每条指令有三列数据，分别为：距上一条指令的延迟（帧），按下或松开的按键，按下（`1`）还是松开（`0`）该按键。

      * 如果游戏目录内存在 `_replay_2_play.txt`，则游戏启动时会将其作为回放播放。

  * replay.1 (2022-04-18 19:42)

    移除了 `record` 调试指令，现在启动游戏会自动开始录制。

  * replay.2 (2022-04-18 19:52)

    现在从回放文件播放的操作也会被包含在录制中。

  * replay.3 (2022-04-19 12:20)

      * 现在在回放播放结束后，游戏才会接受键盘输入。

      * 添加了 `fps` 调试指令，使用 `fps <自然数>` 可以更改游戏的帧率。

  * replay.3a (2022-04-19 12:34)

    调试控制台的输出现在也会被发送到程序的标准输出。但由于某种原因，游戏启动时进程会很快返回，在一个新进程中运行游戏，所以并不能读取到标准输出。

  * replay.3b (2022-04-19 12:25)

    现在可以使用游戏程序暴露的 API 来获取回放的播放情况：

    ~~~cpp
    extern "C" int GetReplayLine(int *currentLine, int *framesLeftToWait);
    ~~~

  * replay.3c (2022-04-19 13:07)

    修复了回放最后一行不会被执行的 bug。

  * replay.3d (2022-04-21 13:30)

      * 现在如果游戏目录内存在 `_start.txt`，则其中的每一行会在游戏启动时作为调试指令自动执行。

      * 添加了 `step` 调试指令，使用 `step <正整数>` 来使游戏全速运行指定帧数。

  * replay.3e (2022-04-21 18:02)

      * 修复了 `_start.txt` 文件末尾存在换行符时行为异常的 bug。

      * 修复了回放文件中没有指令时玩家无法操作游戏的 bug。

  * replay.3f (2022-04-24 13:48)

      调试控制台的输出现在也会被写入程序运行时的工作目录下的 `out.txt` 文件。
